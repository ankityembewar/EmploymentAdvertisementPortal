"use strict";import D from"../Core/Defaults.js";const setOptions=D["setOptions"];import H from"../Core/Globals.js";const composed=H["composed"];import MapNavigationDefaults from"./MapNavigationDefaults.js";import MapPointer from"./MapPointer.js";import MapSymbols from"./MapSymbols.js";import U from"../Core/Utilities.js";const{addEvent,extend,merge,objectEach,pick,pushUnique}=U;function stopEvent(t){t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)}class MapNavigation{static compose(t,e,o){MapPointer.compose(e),MapSymbols.compose(o),pushUnique(composed,"Map.Navigation")&&(addEvent(t,"beforeRender",function(){this.mapNavigation=new MapNavigation(this),this.mapNavigation.update()}),setOptions(MapNavigationDefaults))}constructor(t){this.chart=t,this.navButtons=[]}update(t){function l(t){this.handler.call(u,t),stopEvent(t)}const h=this,u=h.chart,c=h.navButtons;let m=u.options.mapNavigation,b;for(t&&(m=u.options.mapNavigation=merge(u.options.mapNavigation,t));c.length;)c.pop().destroy();if(!u.renderer.forExport&&pick(m.enableButtons,m.enabled)){h.navButtonsGroup||(h.navButtonsGroup=u.renderer.g().attr({zIndex:7}).add()),objectEach(m.buttons,(t,e)=>{t=merge(m.buttonOptions,t),!u.styledMode&&t.theme&&((b=t.theme).style=merge(t.theme.style,t.style));var{text:o,width:n=0,height:i=0,padding:a=0}=t;const s=u.renderer.button("+"!==o&&"-"!==o&&o||"",0,0,l,b,void 0,void 0,void 0,"zoomIn"===e?"topbutton":"bottombutton").addClass("highcharts-map-navigation highcharts-"+{zoomIn:"zoom-in",zoomOut:"zoom-out"}[e]).attr({width:n,height:i,title:u.options.lang[e],padding:t.padding,zIndex:5}).add(h.navButtonsGroup);if("+"===o||"-"===o){const r=n+1,d=[["M",a+3,a+i/2],["L",a+r-3,a+i/2]];"+"===o&&d.push(["M",a+r/2,a+3],["L",a+r/2,a+i-3]),u.renderer.path(d).addClass("highcharts-button-symbol").attr(u.styledMode?{}:{stroke:t.style?.color,"stroke-width":3,"stroke-linecap":"round"}).add(s)}if(s.handler=t.onclick,addEvent(s.element,"dblclick",stopEvent),c.push(s),extend(t,{width:s.width,height:2*(s.height||0)}),u.hasLoaded)s.align(t,!1,t.alignTo);else{const p=addEvent(u,"load",()=>{s.element&&s.align(t,!1,t.alignTo),p()})}});const n=(t,e)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y);u.hasLoaded||addEvent(u,"render",function(){var t,e,o=u.exportingGroup&&u.exportingGroup.getBBox();o&&(e=h.navButtonsGroup.getBBox(),n(o,e)&&(t=-e.y-e.height+o.y-5,o=o.y+o.height-e.y+5,e=m.buttonOptions&&m.buttonOptions.verticalAlign,h.navButtonsGroup.attr({translateY:"bottom"===e?t:o})))})}this.updateEvents(m)}updateEvents(t){const e=this.chart;pick(t.enableDoubleClickZoom,t.enabled)||t.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||addEvent(e.container,"dblclick",function(t){e.pointer.onContainerDblClick(t)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick()),pick(t.enableMouseWheelZoom,t.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||addEvent(e.container,"wheel",function(t){return e.pointer.inClass(t.target,"highcharts-no-mousewheel")||(e.pointer.onContainerMouseWheel(t),stopEvent(t)),!1}):this.unbindMouseWheel&&(this.unbindMouseWheel=this.unbindMouseWheel())}}export default MapNavigation;