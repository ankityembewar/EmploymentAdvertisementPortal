"use strict";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{line:LineSeries}=SeriesRegistry["seriesTypes"];import U from"../../Core/Utilities.js";const{extend,merge,objectEach,pick}=U;class AreaSeries extends LineSeries{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);const{areaPath:a,options:o}=this;[this,...this.zones].forEach((t,e)=>{const s={},i=t.fillColor||o.fillColor;let r=t.area;var l=r?"animate":"attr";r?(r.endX=this.preventGraphAnimation?null:a.xMap,r.animate({d:a})):(s.zIndex=0,(r=t.area=this.chart.renderer.path(a).addClass("highcharts-area"+(e?` highcharts-zone-area-${e-1} `:" ")+(e&&t.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(s.fill=i||t.color||this.color,s["fill-opacity"]=i?1:o.fillOpacity??.75,r.css({pointerEvents:this.stickyTracking?"none":"auto"})),r[l](s),r.startX=a.xMap,r.shiftUnit=o.step?2:1})}getGraphPath(n){function s(t,e,s){var t=n[t],i=h&&d[t.x].points[u],r=t[s+"Null"]||0,t=t[s+"Cliff"]||0;let l,a,o=!0;t||r?(l=(r?i[0]:i[1])+t,a=i[0]+t,o=!!r):!h&&n[e]&&n[e].isNull&&(l=a=g),void 0!==l&&(f.push({plotX:k,plotY:null===l?x:p.getThreshold(l),isNull:o,isCliff:!0}),c.push({plotX:k,plotY:null===a?x:p.getThreshold(a),doCurve:!1}))}const t=LineSeries.prototype.getGraphPath,e=this.options,h=e.stacking,p=this.yAxis,c=[],f=[],u=this.index,d=p.stacking.stacks[this.stackKey],g=e.threshold,x=Math.round(p.getThreshold(e.threshold)),i=pick(e.connectNulls,"percent"===h);let k,r,l;n=n||this.points;for(let t=0,e=(n=h?this.getStackPoints(n):n).length;t<e;++t)h||(n[t].leftCliff=n[t].rightCliff=n[t].leftNull=n[t].rightNull=void 0),r=n[t].isNull,k=pick(n[t].rectPlotX,n[t].plotX),l=h?pick(n[t].yBottom,x):x,r&&!i||(i||s(t,t-1,"left"),r&&!h&&i||(f.push(n[t]),c.push({x:t,plotX:k,plotY:l})),i||s(t,t+1,"right"));const a=t.call(this,f,!0,!0),o=(c.reversed=!0,t.call(this,c,!0,!0));var y=o[0];y&&"M"===y[0]&&(o[0]=["L",y[1],y[2]]);const S=a.concat(o);S.length&&S.push(["Z"]);y=t.call(this,f,!1,i);return S.xMap=a.xMap,this.areaPath=S,y}getStackPoints(e){const p=this,i=[],c=[],r=this.xAxis,l=this.yAxis,f=l.stacking.stacks[this.stackKey],u={},d=l.series,g=d.length,x=l.options.reversedStacks?1:-1,k=d.indexOf(p);if(e=e||this.points,this.options.stacking){for(let t=0;t<e.length;t++)e[t].leftNull=e[t].rightNull=void 0,u[e[t].x]=e[t];objectEach(f,function(t,e){null!==t.total&&c.push(e)}),c.sort(function(t,e){return t-e});const y=d.map(t=>t.visible);c.forEach(function(a,o){let e=0,n,h;if(u[a]&&!u[a].isNull)i.push(u[a]),[-1,1].forEach(function(t){var e=1===t?"rightNull":"leftNull",s=1===t?"rightCliff":"leftCliff",i=f[c[o+t]];let r=0;if(i){let t=k;for(;0<=t&&t<g;){var l=d[t].index;(n=i.points[l])||(l===p.index?u[a][e]=!0:y[t]&&(h=f[a].points[l])&&(r-=h[1]-h[0])),t+=x}}u[a][s]=r});else{let t=k;for(;0<=t&&t<g;){var s=d[t].index;if(n=f[a].points[s]){e=n[1];break}t+=x}e=pick(e,0),e=l.translate(e,0,1,0,1),i.push({isNull:!0,plotX:r.translate(a,0,0,0,1),x:a,plotY:e,yBottom:e})}})}return i}}AreaSeries.defaultOptions=merge(LineSeries.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),extend(AreaSeries.prototype,{singleStacks:!1}),SeriesRegistry.registerSeriesType("area",AreaSeries);export default AreaSeries;